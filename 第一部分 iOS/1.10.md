
## UIWebViewåŠ è½½ç½‘é¡µå†…å®¹

å¯ä»¥é€šè¿‡æœ¬åœ°æ–‡ä»¶ã€urlç­‰æ–¹å¼ã€‚

```objective-c
NSString *htmlPath = [[NSBundle mainBundle] pathForResource:@"index" ofType:@"html"];
NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL fileURLWithPath:htmlPath]];
[self.webView loadRequest:request];
```

## Nativeè°ƒç”¨JavaScript

Nativeè°ƒç”¨JSæ˜¯é€šè¿‡UIWebViewçš„stringByEvaluatingJavaScriptFromString æ–¹æ³•å®ç°çš„ï¼Œè¯¥æ–¹æ³•è¿”å›jsè„šæœ¬çš„æ‰§è¡Œç»“æœã€‚

```objective-c
[webView stringByEvaluatingJavaScriptFromString:@"Math.random();"];
```

å®é™…ä¸Šå°±æ˜¯è°ƒç”¨äº†ç½‘é¡µçš„Windowä¸‹çš„ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦è®©nativeç«¯è°ƒç”¨jsæ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªjsæ–¹æ³•å¿…é¡»åœ¨windowä¸‹å¯ä»¥è®¿é—®åˆ°ã€‚


## JavaScriptè°ƒç”¨Native

åè¿‡æ¥ï¼ŒJavaScriptè°ƒç”¨Nativeï¼Œå¹¶æ²¡æœ‰ç°æˆçš„APIå¯ä»¥è°ƒç”¨ï¼Œè€Œæ˜¯é—´æ¥åœ°é€šè¿‡ä¸€äº›å…¶å®ƒæ‰‹æ®µæ¥å®ç°ã€‚UIWebViewæœ‰ä¸ªä»£ç†æ–¹æ³•ï¼šåœ¨UIWebViewå†…å‘èµ·çš„ä»»ä½•ç½‘ç»œè¯·æ±‚éƒ½å¯ä»¥é€šè¿‡delegateå‡½æ•°åœ¨Nativeå±‚å¾—åˆ°é€šçŸ¥ã€‚ç”±æ­¤æ€è·¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨UIWebViewå†…å‘èµ·ä¸€ä¸ªè‡ªå®šä¹‰çš„ç½‘ç»œè¯·æ±‚ï¼Œé€šå¸¸æ˜¯è¿™æ ·çš„æ ¼å¼ï¼š**jsbridge://methodName?param1=value1&param2=value2...**

åœ¨UIWebViewçš„delegateå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åˆ¤æ–­è¯·æ±‚çš„schemeï¼Œå¦‚æœrequest.URL.schemeæ˜¯jsbridgeï¼Œé‚£ä¹ˆå°±ä¸è¿›è¡Œç½‘é¡µå†…å®¹çš„åŠ è½½ï¼Œè€Œæ˜¯å»æ‰§è¡Œç›¸åº”çš„æ–¹æ³•ã€‚æ–¹æ³•åç§°å°±æ˜¯request.URL.hostã€‚å‚æ•°å¯ä»¥é€šè¿‡request.URL.queryå¾—åˆ°ã€‚

é—®é¢˜æ¥äº†ï¼Ÿï¼Ÿ

å‘èµ·è¿™æ ·1ä¸ªç½‘ç»œè¯·æ±‚æœ‰2ç§æ–¹å¼ã€‚1:location.href .2ï¼šiframeã€‚é€šè¿‡location.hrefæœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœjså¤šæ¬¡è°ƒç”¨åŸç”Ÿçš„æ–¹æ³•ä¹Ÿå°±æ˜¯location.hrefçš„å€¼å¤šæ¬¡å˜åŒ–ï¼ŒNativeç«¯åªèƒ½æ¥å—åˆ°æœ€åä¸€æ¬¡è¯·æ±‚ï¼Œå‰é¢çš„è¯·æ±‚ä¼šè¢«å¿½ç•¥æ‰ã€‚

ä½¿ç”¨ifrmaeæ–¹å¼ï¼Œä»¥è°ƒç”¨Nativeç«¯çš„æ–¹æ³•ã€‚

```javascript
var iFrame;
iFrame = document.createElement("iframe");
iFrame.style.height = "1px";
iFrame.style.width = "1px";
iFrame.style.display = "none";
iFrame.src = url;
document.body.appendChild(iFrame);
setTimeout(function(){
    iFrame.remove();
},100);
```

ä¸¾ä¸ªğŸŒ°ï¼š

éœ€æ±‚ï¼š

åŸç”Ÿç«¯æä¾›ä¸€ä¸ªUIWebViewï¼ŒåŠ è½½ä¸€ä¸ªç½‘é¡µå†…å®¹ã€‚è¿˜æœ‰1ä¸ªæŒ‰é’®ï¼ŒæŒ‰é’®ç‚¹å‡»ä¸€ä¸‹ç½‘é¡µå¢åŠ ä¸€æ®µæ®µè½æ–‡æœ¬ã€‚ç½‘é¡µä¸Šæœ‰2ä¸ªè¾“å…¥æ¡†ï¼Œç”¨æˆ·è¾“å…¥æ•°å­—ï¼Œç‚¹å‡»æŒ‰é’®ï¼Œjså°†ç”¨æˆ·è¾“å…¥çš„å‚æ•°å‘Šè¯‰nativeç«¯ï¼Œnativeå»æ‰§è¡ŒåŠ æ³•ï¼Œè®¡ç®—å®Œæˆåå°†ç»“æœè¿”å›ç»™js

```html
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf8">
    <script language="javascript">
        function loadURL(url) {
            var iFrame;
            iFrame = document.createElement("iframe");
            iFrame.style.height = "1px";
            iFrame.style.width = "1px";
            iFrame.style.display = "none";
            iFrame.src = url;
            document.body.appendChild(iFrame);
            setTimeout(function () {
                iFrame.remove();
            }, 100);
        }


        function receiveValue(value) {
            alert("ä»åŸç”Ÿæ‹¿åˆ°åŠ æ³•ç»“æœä¸ºï¼š" + value);
        }

        function check() {
            var par1 = document.getElementById("par1").value;
            var par2 = document.getElementById("par2").value;
            loadURL("JSBridge://plus?par1=" + par1 + "&par2=" + par2);
        }

    </script>
</head>

<body>
    <input type="text" placeholder="è¯·è¾“å…¥æ•°å­—" id="par1" ï¼> +
    <input type="text" placeholder="è¯·è¾“å…¥æ•°å­—" id="par2" ï¼>
    <input type="button" value="=" onclick="check()" />
</body>
</html>
```

```objective-c
-(void)addContentToWebView{
    NSString *jsString = @" var pNode = document.createElement(\"p\"); pNode.innerText = \"æˆ‘æ˜¯ç”±åŸç”Ÿä»£ç è°ƒç”¨jsåå°†ä¸€æ®µæ–‡ä»¶æ·»åŠ åˆ°htmlä¸Šï¼Œä¹Ÿå°±æ˜¯æ³¨å…¥\";document.body.appendChild(pNode);";
    [self.webView stringByEvaluatingJavaScriptFromString:jsString];
}


-(NSInteger)plusparm:(NSInteger)par1 parm2:(NSInteger)par2{
    return par1 + par2;
}


#pragma mark -- UIWebViewDelegate
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType{
    NSURL *url = request.URL;
    NSString *scheme = url.scheme;
    NSString *method = url.host;
    NSString *parms =  url.query;
    NSArray *pars = [parms componentsSeparatedByString:@"&"];
    NSInteger par1 = [[pars[0] substringFromIndex:5] integerValue];
    NSInteger par2 = [[pars[1] substringFromIndex:5] integerValue];
    if ([scheme isEqualToString:@"jsbridge"]) {
    //å‘ç°schemeæ˜¯JSBridgeï¼Œé‚£ä¹ˆå°±æ˜¯è‡ªå®šä¹‰çš„URLschemeï¼Œä¸å»åŠ è½½ç½‘é¡µå†…å®¹è€Œæ‹¦æˆªå»å¤„ç†äº‹ä»¶ã€‚

        if ([method isEqualToString:@"plus"]) {
            NSInteger result = [self plusparm:par1 parm2:par2];
            [self.webView stringByEvaluatingJavaScriptFromString:[NSString stringWithFormat:@"receiveValue(%@);",@(result)]];
        }

        return NO;
    }
    return YES;
}
```


## åŒæ­¥å’Œå¼‚æ­¥é—®é¢˜

jsè°ƒç”¨nativeæ˜¯é€šè¿‡åœ¨ä¸€ä¸ªç½‘é¡µä¸Šæ’å…¥ä¸€ä¸ªiframeï¼Œè¿™ä¸ªiframeæ’å…¥å®Œäº†å°±å®Œäº†ï¼Œæ‰§è¡Œçš„ç»“æœéœ€è¦nativeå¦å¤–è°ƒç”¨stringByEvaluatingJavaScriptString æ–¹æ³•é€šçŸ¥jsã€‚è¿™æ˜æ˜¾æ˜¯1ä¸ªå¼‚æ­¥çš„è°ƒç”¨ã€‚è€ŒstringByEvaluatingJavaScriptStringæ–¹æ³•ä¼šè¿”å›æ‰§è¡Œjsè„šæœ¬çš„ç»“æœã€‚æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŒæ­¥è°ƒç”¨

æ‰€ä»¥js call nativeæ˜¯å¼‚æ­¥ï¼Œnative call jsæ˜¯åŒæ­¥ã€‚
